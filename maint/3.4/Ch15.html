<!DOCTYPE html><html>
<head>
<title>15 Stream Connectors‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4</title>
<!--Generated on Sat May  1 09:01:01 2021 by LaTeXML (version 0.8.3) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on April 10, 2017.-->

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="LaTeXML.css" type="text/css">
<link rel="stylesheet" href="ltx-report.css" type="text/css">
<link rel="stylesheet" href="ltx-listings.css" type="text/css">
<link rel="stylesheet" href="css/LaTeXML-navbar-left.css" type="text/css">
<script src="css/LatexML-maybeMathJax.js" type="text/javascript"></script>
<link rel="up" href="MLS.html" title="Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="start" href="MLS.html" title="Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="prev" href="Ch14.html" title="Chapter 14 Overloaded Operators ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="next" href="Ch16.html" title="Chapter 16 Synchronous Language Elements ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Chx1.html" title="Preface ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch1.html" title="Chapter 1 Introduction ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch2.html" title="Chapter 2 Lexical Structure ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch3.html" title="Chapter 3 Operators and Expressions ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch4.html" title="Chapter 4 Classes, Predefined Types, and Declarations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch5.html" title="Chapter 5 Scoping, Name Lookup, and Flattening ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch6.html" title="Chapter 6 Interface or Type Relationships ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch7.html" title="Chapter 7 Inheritance, Modification, and Redeclaration ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch8.html" title="Chapter 8 Equations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch9.html" title="Chapter 9 Connectors and Connections ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch10.html" title="Chapter 10 Arrays ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch11.html" title="Chapter 11 Statements and Algorithm Sections ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch12.html" title="Chapter 12 Functions ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch13.html" title="Chapter 13 Packages ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch14.html" title="Chapter 14 Overloaded Operators ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch16.html" title="Chapter 16 Synchronous Language Elements ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch17.html" title="Chapter 17 State Machines ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch18.html" title="Chapter 18 Annotations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch19.html" title="Chapter 19 Unit Expressions ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="chapter" href="Ch20.html" title="Chapter 20 The Modelica Standard Library ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="appendix" href="A1.html" title="Appendix A Glossary ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="appendix" href="A2.html" title="Appendix B Modelica Concrete Syntax ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="appendix" href="A3.html" title="Appendix C Modelica DAE Representation ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="appendix" href="A4.html" title="Appendix D Derivation of Stream Equations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="appendix" href="A5.html" title="Appendix E Modelica Revision History ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
<link rel="appendix" href="A6.html" title="Appendix F Literature ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4">
</head>
<body>
<nav class="ltx_page_navbar"><a href="MLS.html" title="Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref" rel="start"><span class="ltx_text ltx_ref_title">Modelica® - A Unified Object-Oriented Language for Systems
Modeling<span class="ltx_text"> </span>Language
Specification<span class="ltx_text"> </span>Version 3.4</span></a>
<div class="ltx_TOC">
<ul class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Chx1.html" title="Preface ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title">Preface</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch1.html" title="Chapter 1 Introduction ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch2.html" title="Chapter 2 Lexical Structure ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Lexical Structure</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch3.html" title="Chapter 3 Operators and Expressions ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Operators and Expressions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch4.html" title="Chapter 4 Classes, Predefined Types, and Declarations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Classes, Predefined Types, and Declarations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch5.html" title="Chapter 5 Scoping, Name Lookup, and Flattening ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Scoping, Name Lookup, and Flattening</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch6.html" title="Chapter 6 Interface or Type Relationships ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Interface or Type Relationships</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch7.html" title="Chapter 7 Inheritance, Modification, and Redeclaration ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Inheritance, Modification, and Redeclaration</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch8.html" title="Chapter 8 Equations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Equations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch9.html" title="Chapter 9 Connectors and Connections ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9 </span>Connectors and Connections</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch10.html" title="Chapter 10 Arrays ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">10 </span>Arrays</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch11.html" title="Chapter 11 Statements and Algorithm Sections ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">11 </span>Statements and Algorithm Sections</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch12.html" title="Chapter 12 Functions ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">12 </span>Functions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch13.html" title="Chapter 13 Packages ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">13 </span>Packages</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch14.html" title="Chapter 14 Overloaded Operators ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">14 </span>Overloaded Operators</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter ltx_ref_self">
<span class="ltx_ref ltx_ref_self"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">15 </span>Stream Connectors</span></span>
<ul class="ltx_toclist ltx_toclist_chapter">
<li class="ltx_tocentry ltx_tocentry_section"><a href="#definition-of-stream-connectors" title="15.1 Definition of Stream Connectors ‣ Chapter 15 Stream Connectors ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">15.1 </span>Definition of Stream Connectors</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#stream-operator-instream-and-connection-equations" title="15.2 Stream Operator inStream and Connection Equations ‣ Chapter 15 Stream Connectors ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">15.2 </span>Stream Operator inStream and Connection Equations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a href="#stream-operator-actualstream" title="15.3 Stream Operator actualStream ‣ Chapter 15 Stream Connectors ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">15.3 </span>Stream Operator actualStream</span></a></li>
</ul>
</li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch16.html" title="Chapter 16 Synchronous Language Elements ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">16 </span>Synchronous Language Elements</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch17.html" title="Chapter 17 State Machines ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">17 </span>State Machines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch18.html" title="Chapter 18 Annotations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">18 </span>Annotations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch19.html" title="Chapter 19 Unit Expressions ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">19 </span>Unit Expressions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_chapter"><a href="Ch20.html" title="Chapter 20 The Modelica Standard Library ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">20 </span>The Modelica Standard Library</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a href="A1.html" title="Appendix A Glossary ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Glossary</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a href="A2.html" title="Appendix B Modelica Concrete Syntax ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Modelica Concrete Syntax</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a href="A3.html" title="Appendix C Modelica DAE Representation ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Modelica DAE Representation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a href="A4.html" title="Appendix D Derivation of Stream Equations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Derivation of Stream Equations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a href="A5.html" title="Appendix E Modelica Revision History ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Modelica Revision History</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a href="A6.html" title="Appendix F Literature ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Literature</span></a></li>
</ul>
</div>
</nav>
<div class="ltx_page_main">
<header class="ltx_page_header">
<div>
<a href="MLS.html" title="Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref" rel="up"><span class="ltx_text ltx_ref_title">Modelica® - A Unified Object-Oriented Language for Systems
Modeling<span class="ltx_text"> </span>Language
Specification<span class="ltx_text"> </span>Version 3.4</span></a><a href="Ch14.html" title="Chapter 14 Overloaded Operators ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref" rel="prev"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">14 </span>Overloaded Operators</span></a><a href="Ch16.html" title="Chapter 16 Synchronous Language Elements ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref" rel="next"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">16 </span>Synchronous Language Elements</span></a>
</div></header>
<div class="ltx_page_content">
<section class="ltx_chapter ltx_authors_1line">
<h1 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">Chapter 15 </span>Stream Connectors</h1>
<div class="ltx_date ltx_role_creation"></div>

<div id="Ch15.p1" class="ltx_para">
<p class="ltx_p">The two basic variable types in a connector – “potential” (or across)
variable and “flow” (or through) variable – are not sufficient to
describe in a numerically sound way the bi-directional flow of matter
with convective transport of specific quantities, such as specific
enthalpy and chemical composition. The values of these specific
quantities are determined from the upstream side of the flow, i.e., they
depend on the flow direction. When using across and through variables,
the corresponding models would include nonlinear systems of equations
with Boolean unknowns for the flow directions and singularities around
zero flow. Such equation systems cannot be solved reliably in general.
The model formulations can be simplified when formulating two different
balance equations for the two possible flow directions. This is not
possible with across and through variables though.</p>
</div>
<div id="Ch15.p2" class="ltx_para">
<p class="ltx_p">This fundamental problem is addressed in Modelica by introducing a third
type of connector variable, called stream variable, declared with the
prefix <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;background-color:#FFFFFF;">stream</span>. A stream variable describes a quantity that is
carried by a flow variable, i.e., a purely convective transport
phenomenon. The value of the stream variable is the specific property
inside the component close to the boundary, assuming that matter flows
out of the component into the connection point. In other words, it is
the value the carried quantity would have if the fluid was flowing out
of the connector, irrespective of the actual flow direction.</p>
</div>
<div id="Ch15.p3" class="ltx_para">
<p class="ltx_p">The rationale of the definition and typical use cases are described in
<a href="A4.html" title="Appendix D Derivation of Stream Equations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix D</span></a>.</p>
</div>
<section id="definition-of-stream-connectors" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">15.1 </span>Definition of Stream Connectors</h2>

<div id="Ch15.S1.p1" class="ltx_para">
<p class="ltx_p">If at least one variable in a connector has the <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;background-color:#FFFFFF;">stream</span> prefix,
the connector is called “stream connector” and the corresponding
variable is called “stream variable”. The following definitions hold:</p>
</div>
<div id="Ch15.S1.p2" class="ltx_para">
<ul id="Ch15.S1.I1" class="ltx_itemize">
<li id="Ch15.S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S1.I1.i1.p1" class="ltx_para">
<p class="ltx_p">The <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;background-color:#FFFFFF;">stream</span> prefix can only be used in a connector
declaration.</p>
</div>
</li>
<li id="Ch15.S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S1.I1.i2.p1" class="ltx_para">
<p class="ltx_p">A stream connector must have exactly one scalar variable with the
<span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;background-color:#FFFFFF;">flow</span> prefix. [<span class="ltx_text ltx_emph ltx_font_italic">The idea is that all stream variables
of a connector are associated with this flow variable</span>]<span class="ltx_text ltx_emph ltx_font_italic">.</span></p>
</div>
</li>
<li id="Ch15.S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S1.I1.i3.p1" class="ltx_para">
<p class="ltx_p">For every outside connector [<span class="ltx_text ltx_emph ltx_font_italic">see <a href="Ch9.html#inside-and-outside-connectors" title="9.1.2 Inside and Outside Connectors ‣ 9.1 Connect-Equations and Connectors ‣ Chapter 9 Connectors and Connections ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 9.1.2</span></a></span>], one
equation is generated for every variable with the <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;background-color:#FFFFFF;">stream</span>
prefix [<span class="ltx_text ltx_emph ltx_font_italic">to describe the propagation of the stream variable
along a model hierarchy</span>]. For the exact definition, see the end of
<a href="#stream-operator-instream-and-connection-equations" title="15.2 Stream Operator inStream and Connection Equations ‣ Chapter 15 Stream Connectors ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 15.2</span></a>.</p>
</div>
</li>
<li id="Ch15.S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S1.I1.i4.p1" class="ltx_para">
<p class="ltx_p">For inside connectors [<span class="ltx_text ltx_emph ltx_font_italic">see <a href="Ch9.html#inside-and-outside-connectors" title="9.1.2 Inside and Outside Connectors ‣ 9.1 Connect-Equations and Connectors ‣ Chapter 9 Connectors and Connections ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 9.1.2</span></a></span>], variables
with the <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;background-color:#FFFFFF;">stream</span> prefix do not lead to connection equations.</p>
</div>
</li>
<li id="Ch15.S1.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S1.I1.i5.p1" class="ltx_para">
<p class="ltx_p">Connection equations with stream variables are generated in a model
when using the <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">()</span></span> operator or the
<span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">actualStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">()</span></span> operator, see <a href="#stream-operator-instream-and-connection-equations" title="15.2 Stream Operator inStream and Connection Equations ‣ Chapter 15 Stream Connectors ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 15.2</span></a>
and <a href="#stream-operator-actualstream" title="15.3 Stream Operator actualStream ‣ Chapter 15 Stream Connectors ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 15.3</span></a>.</p>
</div>
</li>
</ul>
</div>
<div id="Ch15.S1.p3" class="ltx_para">
<p class="ltx_p">[<span class="ltx_text ltx_emph ltx_font_italic">Example:</span></p>
</div>
<div id="Ch15.S1.p4" class="ltx_para">
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,Y29ubmVjdG9yIEZsdWlkUG9ydAogIHJlcGxhY2VhYmxlIHBhY2thZ2UgTWVkaXVtID0KICAgIE1vZGVsaWNhLk1lZGlhLkludGVyZmFjZXMuUGFydGlhbE1lZGl1bTsKICBNZWRpdW0uQWJzb2x1dGVQcmVzc3VyZSBwICJQcmVzc3VyZSBpbiBjb25uZWN0aW9uIHBvaW50IjsKICBmbG93IE1lZGl1bS5NYXNzRmxvd1JhdGUgbV9mbG93ICI+IDAsIGlmIGZsb3cgaW50byBjb21wb25lbnQiOwogIHN0cmVhbSBNZWRpdW0uU3BlY2lmaWNFbnRoYWxweSBoX291dGZsb3cgImggY2xvc2UgdG8gcG9ydCBpZiBtX2Zsb3cgPCAwIjsKICBzdHJlYW0gTWVkaXVtLk1hc3NGcmFjdGlvbiBYX291dGZsb3dbTWVkaXVtLm5YXSAiWCBjbG9zZSB0byBwb3J0IGlmIG1fZmxvdyA8IDAiOwplbmQgRmx1aWRQb3J0Ow==">⬇</a></div>
<div id="lstnumberx3317" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">connector</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">FluidPort</span>
</div>
<div id="lstnumberx3318" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">replaceable</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">package</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">Medium</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span>
</div>
<div id="lstnumberx3319" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">    </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">Modelica.Media.Interfaces.PartialMedium</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3320" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">Medium.AbsolutePressure</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">p</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" style="font-size:90%;color:#000000;">"Pressure<span class="ltx_text ltx_lst_space"> </span>in<span class="ltx_text ltx_lst_space"> </span>connection<span class="ltx_text ltx_lst_space"> </span>point"</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3321" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">Medium.MassFlowRate</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" style="font-size:90%;color:#000000;">"&gt;<span class="ltx_text ltx_lst_space"> </span>0,<span class="ltx_text ltx_lst_space"> </span>if<span class="ltx_text ltx_lst_space"> </span>flow<span class="ltx_text ltx_lst_space"> </span>into<span class="ltx_text ltx_lst_space"> </span>component"</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3322" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">stream</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">Medium.SpecificEnthalpy</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" style="font-size:90%;color:#000000;">"h<span class="ltx_text ltx_lst_space"> </span>close<span class="ltx_text ltx_lst_space"> </span>to<span class="ltx_text ltx_lst_space"> </span>port<span class="ltx_text ltx_lst_space"> </span>if<span class="ltx_text ltx_lst_space"> </span>m_flow<span class="ltx_text ltx_lst_space"> </span>&lt;<span class="ltx_text ltx_lst_space"> </span>0"</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3323" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">stream</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">Medium.MassFraction</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">X_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">[</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">Medium.nX</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">]</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" style="font-size:90%;color:#000000;">"X<span class="ltx_text ltx_lst_space"> </span>close<span class="ltx_text ltx_lst_space"> </span>to<span class="ltx_text ltx_lst_space"> </span>port<span class="ltx_text ltx_lst_space"> </span>if<span class="ltx_text ltx_lst_space"> </span>m_flow<span class="ltx_text ltx_lst_space"> </span>&lt;<span class="ltx_text ltx_lst_space"> </span>0"</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3324" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">end</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">FluidPort</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">FluidPort is a stream connector, because some connector variables
have the <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold ltx_font_upright" style="font-size:90%;color:#000066;background-color:#FFFFFF;">stream</span> prefix. The Medium definition and the stream
variables are associated with the only flow variable (m_flow) that
defines a fluid stream. The Medium and the stream variables are
transported with this flow variable. The stream variables h_outflow and
X_outflow are the stream properties inside the component close to the
boundary, when fluid flows out of the component into the connection
point. The stream properties for the other flow direction can be
inquired with the built-in operator <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter ltx_font_upright" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter ltx_font_upright" style="font-size:90%;">()</span></span>. The value of
the stream variable corresponding to the actual flow direction can be
inquired through the built-in operator <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter ltx_font_upright" style="font-size:90%;color:#E60000;">actualStream</span><span class="ltx_text ltx_font_typewriter ltx_font_upright" style="font-size:90%;">()</span></span>, see
<a href="#stream-operator-actualstream" title="15.3 Stream Operator actualStream ‣ Chapter 15 Stream Connectors ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 15.3</span></a>.</span>]</p>
</div>
</section>
<section id="stream-operator-instream-and-connection-equations" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">15.2 </span>Stream Operator inStream and Connection Equations</h2>

<div id="Ch15.S2.p1" class="ltx_para">
<p class="ltx_p">In combination with the stream variables of a connector, the
<span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">()</span></span> operator is designed to describe in a numerically
reliable way the bi-directional transport of specific quantities carried
by a flow of matter.</p>
</div>
<div id="Ch15.S2.p2" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(<span class="ltx_text ltx_lst_identifier">v</span>)</span></span> is only allowed on stream variables <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">v</span> and is
informally the value the stream variable has, assuming that the flow is
from the connection point into the component. This value is computed
from the stream connection equations of the flow variables and of the
stream variables.</p>
</div>
<div id="Ch15.S2.p3" class="ltx_para">
<p class="ltx_p">For the following definition it is assumed that <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">N</span> inside connectors
<span class="ltx_text ltx_font_typewriter">m<sub class="ltx_sub">j</sub>.c</span> (j=1,2,…,N) and <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">M</span> outside connectors
<span class="ltx_text ltx_font_typewriter">c<sub class="ltx_sub">k</sub></span> (k=1,2,…,M) belonging to the same connection set
[<span class="ltx_text ltx_emph ltx_font_italic">see definition in <a href="Ch9.html#inside-and-outside-connectors" title="9.1.2 Inside and Outside Connectors ‣ 9.1 Connect-Equations and Connectors ‣ Chapter 9 Connectors and Connections ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 9.1.2</span></a></span>] are connected
together and a stream variable <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">h_outflow</span> is associated with a flow
variable <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">m_flow</span> in connector <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">c</span>.</p>
</div>
<div id="Ch15.S2.p4" class="ltx_para">
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,Y29ubmVjdG9yIEZsdWlkUG9ydAogIC4uLgogIGZsb3cgUmVhbCBtX2Zsb3cgIkZsb3cgb2YgbWF0dGVyOyBtX2Zsb3cgPiAwIGlmIGZsb3cgaW50byBjb21wb25lbnQiOwogIHN0cmVhbSBSZWFsIGhfb3V0ZmxvdyAiU3BlY2lmaWMgdmFyaWFibGUgaW4gY29tcG9uZW50IGlmIG1fZmxvdyA8IDAiCmVuZCBGbHVpZFBvcnQKCm1vZGVsIEZsdWlkU3lzdGVtCiAgLi4uCiAgRmx1aWRDb21wb25lbnQgJG1fMSQsICRtXzIkLCAuLi4sCiAgbV9OOwogIEZsdWlkUG9ydCAkY18xJCwgJGNfMiQsIC4uLiwKICBjX007CmVxdWF0aW9uCiAgY29ubmVjdCgkbV8xJC5jLCAkbV8yJC5jKTsKICBjb25uZWN0KCRtXzEkLmMsICRtXzMkLmMpOwogIC4uLgogIGNvbm5lY3QoJG1fMSQuYywgJG1fTiQuYyk7CiAgY29ubmVjdCgkbV8xJC5jLCAkY18xJCk7CiAgY29ubmVjdCgkbV8xJC5jLCAkY18yJCk7CiAgLi4uCiAgY29ubmVjdCgkbV8xJC5jLCAkY19NJCk7CiAgLi4uCmVuZCBGbHVpZFN5c3RlbTs=">⬇</a></div>
<div id="lstnumberx3325" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">connector</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">FluidPort</span>
</div>
<div id="lstnumberx3326" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">...</span>
</div>
<div id="lstnumberx3327" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">Real</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" style="font-size:90%;color:#000000;">"Flow<span class="ltx_text ltx_lst_space"> </span>of<span class="ltx_text ltx_lst_space"> </span>matter;<span class="ltx_text ltx_lst_space"> </span>m_flow<span class="ltx_text ltx_lst_space"> </span>&gt;<span class="ltx_text ltx_lst_space"> </span>0<span class="ltx_text ltx_lst_space"> </span>if<span class="ltx_text ltx_lst_space"> </span>flow<span class="ltx_text ltx_lst_space"> </span>into<span class="ltx_text ltx_lst_space"> </span>component"</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3328" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">stream</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">Real</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_string ltx_font_typewriter" style="font-size:90%;color:#000000;">"Specific<span class="ltx_text ltx_lst_space"> </span>variable<span class="ltx_text ltx_lst_space"> </span>in<span class="ltx_text ltx_lst_space"> </span>component<span class="ltx_text ltx_lst_space"> </span>if<span class="ltx_text ltx_lst_space"> </span>m_flow<span class="ltx_text ltx_lst_space"> </span>&lt;<span class="ltx_text ltx_lst_space"> </span>0"</span>
</div>
<div id="lstnumberx3329" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">end</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">FluidPort</span>
</div>
<div id="lstnumberx3330" class="ltx_listingline">
</div>
<div id="lstnumberx3331" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">model</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">FluidSystem</span>
</div>
<div id="lstnumberx3332" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">...</span>
</div>
<div id="lstnumberx3333" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">FluidComponent</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3333.m1" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3333.m2" class="ltx_Math" alttext="m_{2}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">2</mn></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">...</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span>
</div>
<div id="lstnumberx3334" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">m_N</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3335" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">FluidPort</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3335.m1" class="ltx_Math" alttext="c_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3335.m2" class="ltx_Math" alttext="c_{2}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mn mathbackground="#FFFFFF" mathvariant="normal">2</mn></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">...</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span>
</div>
<div id="lstnumberx3336" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c_M</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3337" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">equation</span>
</div>
<div id="lstnumberx3338" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">connect</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3338.m1" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3338.m2" class="ltx_Math" alttext="m_{2}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">2</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3339" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">connect</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3339.m1" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3339.m2" class="ltx_Math" alttext="m_{3}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">3</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3340" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">...</span>
</div>
<div id="lstnumberx3341" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">connect</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3341.m1" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3341.m2" class="ltx_Math" alttext="m_{N}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">N</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3342" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">connect</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3342.m1" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3342.m2" class="ltx_Math" alttext="c_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3343" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">connect</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3343.m1" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3343.m2" class="ltx_Math" alttext="c_{2}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mn mathbackground="#FFFFFF" mathvariant="normal">2</mn></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3344" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">...</span>
</div>
<div id="lstnumberx3345" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">connect</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3345.m1" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3345.m2" class="ltx_Math" alttext="c_{M}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">M</mi></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3346" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">...</span>
</div>
<div id="lstnumberx3347" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">end</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">FluidSystem</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
</div>
<figure id="Ch15.F1" class="ltx_figure">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 15.1: </span>Examplary FluidSystem with N=3 and M=2</figcaption><img src="media/fluidsystem.png" id="Ch15.F1.g1" class="ltx_graphics ltx_centering" width="208" height="188" alt="">
</figure>
<div id="Ch15.S2.p5" class="ltx_para">
<p class="ltx_p">[<span class="ltx_text ltx_emph ltx_font_italic">The connection set represents an infinitesimally small control
volume, for which the stream connection equations are equivalent to the
conservation equations for mass and energy.</span>]</p>
</div>
<div id="Ch15.S2.p6" class="ltx_para">
<p class="ltx_p">With these prerequisites, the semantics of the expression
<span class="ltx_text ltx_font_typewriter">inStream(m<sub class="ltx_sub">i</sub>.c.h_outflow)</span> is given implicitly by
defining an additional variable <span class="ltx_text ltx_font_typewriter">h_mix_in<sub class="ltx_sub">i</sub></span>, and by
adding to the model the conservation equations for mass and energy
corresponding to the infinitesimally small volume spanning the
connection set. The connection equation for the flow variables has
already been added to the system according to the connection semantics
of flow variables defined in <a href="Ch9.html#generation-of-connection-equations" title="9.2 Generation of Connection Equations ‣ Chapter 9 Connectors and Connections ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 9.2</span></a>.</p>
</div>
<div id="Ch15.S2.p7" class="ltx_para">
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,Ly8gU3RhbmRhcmQgY29ubmVjdGlvbiBlcXVhdGlvbiBmb3IgZmxvdyB2YXJpYWJsZXMKMCA9IHN1bShtX2ouYy5tX2Zsb3cgZm9yIGogaW4gMTpOKSArIHN1bSgtY2subV9mbG93IGZvciBrIGluIDE6TSk7">⬇</a></div>
<div id="lstnumberx3348" class="ltx_listingline">
<span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>Standard<span class="ltx_text ltx_lst_space"> </span>connection<span class="ltx_text ltx_lst_space"> </span>equation<span class="ltx_text ltx_lst_space"> </span>for<span class="ltx_text ltx_lst_space"> </span>flow<span class="ltx_text ltx_lst_space"> </span>variables</span>
</div>
<div id="lstnumberx3349" class="ltx_listingline">
<span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">m_j.c.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">ck.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
</div>
</div>
<div id="Ch15.S2.p8" class="ltx_para">
<p class="ltx_p">Whenever the <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">()</span></span> operator is applied to a stream
variable of an inside connector, the balance equation of the transported
property must be added under the assumption of flow going into the
connector</p>
</div>
<div id="Ch15.S2.p9" class="ltx_para">
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,Ly8gSW1wbGljaXQgZGVmaW5pdGlvbiBvZiB0aGUgaW5TdHJlYW0oKSBvcGVyYXRvciBhcHBsaWVkIHRvIGluc2lkZSBjb25uZWN0b3IgaQowID0gc3VtKG1qLmMubV9mbG93KihpZiBtai5jLm1fZmxvdyA+IDAgb3Igaj09aSB0aGVuIGhfbWl4X2luaSBlbHNlIG1qLmMuaF9vdXRmbG93KQogICAgICAgIGZvciBqIGluIDE6TikgKwogICAgc3VtKC1jay5tX2Zsb3cqIChpZiAtY2subV9mbG93ID4gMCB0aGVuIGhfbWl4X2luaSBlbHNlIGluU3RyZWFtKGNrLmhfb3V0ZmxvdykKICAgICAgICAgZm9yIGsgaW4gMTpNKTsKaW5TdHJlYW0obWkuYy5oX291dGZsb3cpID0gaF9taXhfaW5pOw==">⬇</a></div>
<div id="lstnumberx3350" class="ltx_listingline">
<span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>Implicit<span class="ltx_text ltx_lst_space"> </span>definition<span class="ltx_text ltx_lst_space"> </span>of<span class="ltx_text ltx_lst_space"> </span>the<span class="ltx_text ltx_lst_space"> </span>inStream()<span class="ltx_text ltx_lst_space"> </span>operator<span class="ltx_text ltx_lst_space"> </span>applied<span class="ltx_text ltx_lst_space"> </span>to<span class="ltx_text ltx_lst_space"> </span>inside<span class="ltx_text ltx_lst_space"> </span>connector<span class="ltx_text ltx_lst_space"> </span>i</span>
</div>
<div id="lstnumberx3351" class="ltx_listingline">
<span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">mj.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">*(</span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">mj.c.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">or</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">==</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">h_mix_ini</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">else</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">mj.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span>
</div>
<div id="lstnumberx3352" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">        </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span>
</div>
<div id="lstnumberx3353" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">    </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">ck.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">ck.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">h_mix_ini</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">else</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">ck.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span>
</div>
<div id="lstnumberx3354" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">         </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3355" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">mi.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">h_mix_ini</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
</div>
<div id="Ch15.S2.p10" class="ltx_para">
<p class="ltx_p">Note that the result of the
<span class="ltx_text ltx_font_typewriter">inStream(m<sub class="ltx_sub">i</sub>.c.h_outflow)</span> operator is different
for each port <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">i</span>, because the assumption of flow entering the port is
different for each of them.</p>
</div>
<div id="Ch15.S2.p11" class="ltx_para">
<p class="ltx_p">Additional equations need to be generated for the stream variables of
outside connectors.</p>
</div>
<div id="Ch15.S2.p12" class="ltx_para">
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,Ly8gQWRkaXRpb25hbCBjb25uZWN0aW9uIGVxdWF0aW9ucyBmb3Igb3V0c2lkZSBjb25uZWN0b3JzCmZvciBxIGluIDE6TSBsb29wCiAgMCA9IHN1bSgkbV9qJC5jLm1fZmxvdyooaWYKICAkbV9qJC5jLm1fZmxvdyA+IDAgdGhlbgogIGhfbWl4X291dF9xCiAgZWxzZSAkbV9qJC5jLmhfb3V0ZmxvdykgZm9yIGoKICBpbiAxOk4pICsKICBzdW0oLSRjX2skLm1fZmxvdyogKGlmCiAgLSRjX2skLm1fZmxvdyA+IDAgb3Igaz09cQogIHRoZW4gaF9taXhfb3V0JF9xJAogIGVsc2UgaW5TdHJlYW0oJGNfayQuaF9vdXRmbG93KQogIGZvciBrIGluIDE6TSk7CiAgICAkY19xJC5oX291dGZsb3cgPSBoX21peF9vdXQkX3EkOwogIGVuZCBmb3I7">⬇</a></div>
<div id="lstnumberx3356" class="ltx_listingline">
<span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>Additional<span class="ltx_text ltx_lst_space"> </span>connection<span class="ltx_text ltx_lst_space"> </span>equations<span class="ltx_text ltx_lst_space"> </span>for<span class="ltx_text ltx_lst_space"> </span>outside<span class="ltx_text ltx_lst_space"> </span>connectors</span>
</div>
<div id="lstnumberx3357" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">loop</span>
</div>
<div id="lstnumberx3358" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3358.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">*(</span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">if</span>
</div>
<div id="lstnumberx3359" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3359.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">then</span>
</div>
<div id="lstnumberx3360" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">h_mix_out_q</span>
</div>
<div id="lstnumberx3361" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">else</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3361.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span>
</div>
<div id="lstnumberx3362" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span>
</div>
<div id="lstnumberx3363" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3363.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">if</span>
</div>
<div id="lstnumberx3364" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3364.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">or</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">==</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span>
</div>
<div id="lstnumberx3365" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">h_mix_out$_q$</span>
</div>
<div id="lstnumberx3366" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">else</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3366.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span>
</div>
<div id="lstnumberx3367" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3368" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">    </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3368.m1" class="ltx_Math" alttext="c_{q}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">q</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">h_mix_out$_q$</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3369" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">end</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
</div>
<div id="Ch15.S2.p13" class="ltx_para">
<p class="ltx_p">Neglecting zero flow conditions, the solution of the above-defined
stream connection equations for inStream values of inside connectors and
outflow stream variables of outside connectors is (for a derivation, see
<a href="A4.html" title="Appendix D Derivation of Stream Equations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix D</span></a>):</p>
</div>
<div id="Ch15.S2.p14" class="ltx_para">
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,aW5TdHJlYW0oJG1faSQuYy5oX291dGZsb3cpIDo9CiAgKHN1bShtYXgoLSRtX2okLmMubV9mbG93LDApKiRtX2okLmMuaF9vdXRmbG93IGZvciBqIGluIGNhdCgxLDE6aS0xLCBpKzE6TikgKwogICBzdW0obWF4KCAkY19rJC5tX2Zsb3csMCkqaW5TdHJlYW0oJGNfayQuaF9vdXRmbG93KSBmb3IgayBpbiAxOk0pKS8KICAoc3VtKG1heCgtJG1faiQuYy5tX2Zsb3csMCkgZm9yIGogaW4gIGNhdCgxLDE6aS0xLCBpKzE6TikgKwogICBzdW0obWF4KCAkY19rJC5tX2Zsb3cgLDApIGZvciBrIGluIDE6TSkpOwoKLy8gQWRkaXRpb25hbCBlcXVhdGlvbnMgdG8gYmUgZ2VuZXJhdGVkIGZvciBvdXRzaWRlIGNvbm5lY3RvcnMgcQpmb3IgcSBpbiAxOk0gbG9vcAogICRjX3EkLmhfb3V0ZmxvdyA6PQogICAgKHN1bShtYXgoLSRtX2okLmMubV9mbG93LDApKiRtX2okLmMuaF9vdXRmbG93IGZvciBqIGluIDE6TikgKwogICAgIHN1bShtYXgoICRjX2skLm1fZmxvdywwKSppblN0cmVhbSgkY19rJC5oX291dGZsb3cpIGZvciBrIGluIGNhdCgxLDE6cS0xLCBxKzE6TSkpLwogICAgKHN1bShtYXgoLSRtX2okLmMubV9mbG93LDApIGZvciBqIGluICAxOk4pICsKICAgICBzdW0obWF4KCAkY19rJC5tX2Zsb3cgLDApIGZvciBrIGluIGNhdCgxLDE6cS0xLCBxKzE6TSkpKTsKZW5kIGZvcjs=">⬇</a></div>
<div id="lstnumberx3370" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3370.m1" class="ltx_Math" alttext="m_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">i</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">:=</span>
</div>
<div id="lstnumberx3371" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3371.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)*</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3371.m2" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">cat</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(1,1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">i</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">-1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">i</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span>
</div>
<div id="lstnumberx3372" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">   </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3372.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)*</span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3372.m2" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">))/</span>
</div>
<div id="lstnumberx3373" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3373.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">cat</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(1,1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">i</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">-1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">i</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span>
</div>
<div id="lstnumberx3374" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">   </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3374.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">));</span>
</div>
<div id="lstnumberx3375" class="ltx_listingline">
</div>
<div id="lstnumberx3376" class="ltx_listingline">
<span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>Additional<span class="ltx_text ltx_lst_space"> </span>equations<span class="ltx_text ltx_lst_space"> </span>to<span class="ltx_text ltx_lst_space"> </span>be<span class="ltx_text ltx_lst_space"> </span>generated<span class="ltx_text ltx_lst_space"> </span>for<span class="ltx_text ltx_lst_space"> </span>outside<span class="ltx_text ltx_lst_space"> </span>connectors<span class="ltx_text ltx_lst_space"> </span>q</span>
</div>
<div id="lstnumberx3377" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">loop</span>
</div>
<div id="lstnumberx3378" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3378.m1" class="ltx_Math" alttext="c_{q}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">q</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">:=</span>
</div>
<div id="lstnumberx3379" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">    </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3379.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)*</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3379.m2" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span>
</div>
<div id="lstnumberx3380" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">     </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3380.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)*</span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3380.m2" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">cat</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(1,1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">-1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">))/</span>
</div>
<div id="lstnumberx3381" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">    </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3381.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span>
</div>
<div id="lstnumberx3382" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">     </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3382.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">cat</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(1,1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">-1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)));</span>
</div>
<div id="lstnumberx3383" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">end</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
</div>
<div id="Ch15.S2.p15" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">Note, that</span> <span class="ltx_text ltx_font_typewriter">inStream(c<sub class="ltx_sub">k</sub>.h_outflow)</span> <span class="ltx_text ltx_emph ltx_font_italic">is
computed from the connection set that is present one hierarchical level
above. At this higher level</span> <span class="ltx_text ltx_font_typewriter">c<sub class="ltx_sub">k</sub>.h_outflow</span> <span class="ltx_text ltx_emph ltx_font_italic">is no longer
an outside connector, but an inside connector and then the formula from
above for inside connectors can be used to compute it.</span>
</p>
</div>
<div id="Ch15.S2.p16" class="ltx_para">
<p class="ltx_p">If the argument of <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">()</span></span> is an array, the implicit
equation system holds elementwise, i.e., <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">()</span></span> is
vectorizable.</p>
</div>
<div id="Ch15.S2.p17" class="ltx_para">
<p class="ltx_p">The stream connection equations have singularities and/or multiple
solutions if one or more of the flow variables become zero. When all the
flows are zero, a singularity is always present, so it is necessary to
approximate the solution in an open neighbourhood of that point.
[<span class="ltx_text ltx_emph ltx_font_italic">For example assume that</span> <span class="ltx_text ltx_font_typewriter">m<sub class="ltx_sub">j</sub>.c.m_flow =
c<sub class="ltx_sub">k</sub>.m_flow = 0</span><span class="ltx_text ltx_emph ltx_font_italic">, then all equations above are identically
fulfilled and <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter ltx_font_upright" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter ltx_font_upright" style="font-size:90%;">(<span class="ltx_text ltx_lst_identifier">..</span>)</span></span> can have any value</span>]. However,
specific optimizations may be applied to avoid the regularization if the
flow through one port is zero or non-negative, see <a href="A4.html" title="Appendix D Derivation of Stream Equations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">Appendix D</span></a>. It is
required that the <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">()</span></span> operator is appropriately
approximated when regularization is needed and the approximation must
fulfill the following requirements:</p>
</div>
<div id="Ch15.S2.p18" class="ltx_para">
<ol id="Ch15.S2.I1" class="ltx_enumerate">
<li id="Ch15.S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="Ch15.S2.I1.i1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_typewriter">inStream(m<sub class="ltx_sub">i</sub>.c.h_outflow)</span> and
<span class="ltx_text ltx_font_typewriter">inStream(c<sub class="ltx_sub">k</sub>.h_outflow)</span> must be unique with
respect to all values of the flow and stream variables in the
connection set, and must have a continuous dependency on them.</p>
</div>
</li>
<li id="Ch15.S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="Ch15.S2.I1.i2.p1" class="ltx_para">
<p class="ltx_p">Every solution of the implicit equation system above must fulfill the
equation system identically [<span class="ltx_text ltx_emph ltx_font_italic">upto the usual numerical
accuracy</span>], provided the absolute value of every flow variable in
the connection set is greater than a small value
(<span class="ltx_text ltx_font_typewriter">|m<sub class="ltx_sub">1</sub>.c.m_flow| &gt; eps
<span class="ltx_text ltx_font_bold">and</span> |m<sub class="ltx_sub">2</sub>.c.m_flow|
&gt; eps <span class="ltx_text ltx_font_bold">and</span> ... <span class="ltx_text ltx_font_bold">and</span>
|c<sub class="ltx_sub">M</sub>.m_flow| &gt; eps</span>).</p>
</div>
</li>
</ol>
</div>
<div id="Ch15.S2.p19" class="ltx_para">
<p class="ltx_p">[<span class="ltx_text ltx_emph ltx_font_italic">Based on the above requirements, the following implementation
is recommended:</span></p>
</div>
<div id="Ch15.S2.p20" class="ltx_para">
<ul id="Ch15.S2.I2" class="ltx_itemize">
<li id="Ch15.S2.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I2.i1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">N = 1, M = 0:</span></p>
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,aW5TdHJlYW0oJG1fMSQuYy5oX291dGZsb3cpID0kbV8xJC5jLmhfb3V0Zmxvdzs=">⬇</a></div>
<div id="lstnumberx3384" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3384.m1" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3384.m2" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
</div>
</li>
<li id="Ch15.S2.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I2.i2.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">N = 2, M = 0:</span></p>
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,aW5TdHJlYW0oJG1fMSQuYy5oX291dGZsb3cpID0kbV8yJC5jLmhfb3V0ZmxvdzsKaW5TdHJlYW0oJG1fMiQuYy5oX291dGZsb3cpID0kbV8xJC5jLmhfb3V0Zmxvdzs=">⬇</a></div>
<div id="lstnumberx3385" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3385.m1" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3385.m2" class="ltx_Math" alttext="m_{2}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">2</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3386" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3386.m1" class="ltx_Math" alttext="m_{2}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">2</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3386.m2" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
</div>
</li>
<li id="Ch15.S2.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I2.i3.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">N = 1, M = 1:</span></p>
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,aW5TdHJlYW0oJG1fMSQuYy5oX291dGZsb3cpID1pblN0cmVhbSgkY18xJC5oX291dGZsb3cpOwovLyBBZGRpdGlvbmFsIGVxdWF0aW9uIHRvIGJlIGdlbmVyYXRlZAokY18xJC5oX291dGZsb3cgPSAkbV8xJC5jLmhfb3V0Zmxvdzs=">⬇</a></div>
<div id="lstnumberx3387" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3387.m1" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3387.m2" class="ltx_Math" alttext="c_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3388" class="ltx_listingline">
<span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>Additional<span class="ltx_text ltx_lst_space"> </span>equation<span class="ltx_text ltx_lst_space"> </span>to<span class="ltx_text ltx_lst_space"> </span>be<span class="ltx_text ltx_lst_space"> </span>generated</span>
</div>
<div id="lstnumberx3389" class="ltx_listingline">
<span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3389.m1" class="ltx_Math" alttext="c_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3389.m2" class="ltx_Math" alttext="m_{1}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mn mathbackground="#FFFFFF" mathvariant="normal">1</mn></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
</div>
</li>
<li id="Ch15.S2.I2.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I2.i4.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">N = 0, M = 2:</span></p>
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,Ly8gQWRkaXRpb25hbCBlcXVhdGlvbiB0byBiZSBnZW5lcmF0ZWQKYzEuaF9vdXRmbG93ID0gaW5TdHJlYW0oYzIuaF9vdXRmbG93KTsKYzIuaF9vdXRmbG93ID0gaW5TdHJlYW0oYzEuaF9vdXRmbG93KTs=">⬇</a></div>
<div id="lstnumberx3390" class="ltx_listingline">
<span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>Additional<span class="ltx_text ltx_lst_space"> </span>equation<span class="ltx_text ltx_lst_space"> </span>to<span class="ltx_text ltx_lst_space"> </span>be<span class="ltx_text ltx_lst_space"> </span>generated</span>
</div>
<div id="lstnumberx3391" class="ltx_listingline">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c1.h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c2.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3392" class="ltx_listingline">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c2.h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c1.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
</div>
</div>
</li>
<li id="Ch15.S2.I2.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I2.i5.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_font_bold">All other cases:</span></p>
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,aWYgJG1faiQuYy5tX2Zsb3cubWluID49IDAgIGZvciBhbGwgaiA9IDE6TiB3aXRoIGogPD4gaSAgYW5kCiAgICRjX2skLm1fZmxvdy5tYXggPD0gMCBmb3IgYWxsIGsgPSAxOk0KdGhlbgogICAgaW5TdHJlYW0oJG1faSQuYy5oX291dGZsb3cpID0gICRtX2kkLmMuaF9vdXRmbG93OwogZWxzZQogICAgc2kgPSBzdW0gKG1heCgtJG1faiQuYy5tX2Zsb3csMCkgZm9yIGogaW4gY2F0KDEsMTppLTEsIGkrMTpOKSArCiAgICAgICAgIHN1bShtYXgoICRjX2skLm1fZmxvdyAsMCkgZm9yIGsgIGluIDE6TSk7CiAgICBpblN0cmVhbSgkbV9pJC5jLmhfb3V0ZmxvdykgPQogICAgICAgKHN1bShwb3NpdGl2ZU1heCgtJG1faiQuYy5tX2Zsb3csJHNfaSQpKiRtX2okLmMuaF9vdXRmbG93KQogICAgICArICBzdW0ocG9zaXRpdmVNYXgoJGNfayQubV9mbG93LHNfaSkqaW5TdHJlYW0oJGNfayQuaF9vdXRmbG93KSkpLwogICAgIChzdW0ocG9zaXRpdmVNYXgoLSRtX2okLmMubV9mbG93LHNfaSkpCiAgICAgICAgKyAgc3VtKHBvc2l0aXZlTWF4KCRjX2skLm1fZmxvdyxzX2kpKSkKICAgICAgICAgICAgICAgICAgZm9yIGogaW4gMTpOIGFuZCBpIDw+IGogYW5kICRtX2okLmMubV9mbG93Lm1pbiA8IDAsCiAgICAgICAgICAgICAgICAgIGZvciBrIGluIDE6TSBhbmQgJGNfayQubV9mbG93Lm1heCA+IDAKLy8gQWRkaXRpb25hbCBlcXVhdGlvbnMgdG8gYmUgZ2VuZXJhdGVkCmZvciBxIGluIDE6TSBsb29wCiAgIGlmICRtX2okLmMubV9mbG93Lm1pbiA+PSAwIGZvciBhbGwgaiA9IDE6TiBhbmQKICAgICAgICRjX2skLm1fZmxvdy5tYXggPD0gMCBmb3IgYWxsIGsgPSAxOk0gYW5kIGsgPD4gcQogICB0aGVuCiAgICAgICAkY19xJC5oX291dGZsb3cgPSAwOwogICAgZWxzZQogICAgICAgJHNfcSQgPSAgKHN1bShtYXgoLSRtX2okLmMubV9mbG93LDApIGZvciBqIGluICAxOk4pICsKICAgICAgICAgICAgICAgICAgICBzdW0obWF4KCAkY19rJC5tX2Zsb3cgLDApIGZvciBrIGluIGNhdCgxLDE6cS0xLCBxKzE6TSkpKTsKICAgICAgICRjX3EkLmhfb3V0ZmxvdyA9IChzdW0ocG9zaXRpdmVNYXgoLSRtX2okLmMubV9mbG93LHNfcSkqJG1faiQuYy5oX291dGZsb3cpICsKICAgICAgICAgICAgICAgICBzdW0ocG9zaXRpdmVNYXgoJGNfayQubV9mbG93LCRzX3EkKSogaW5TdHJlYW0oJGNfayQuaF9vdXRmbG93KSkpLwogICAgICAgICAgICAgICAgKHN1bShwb3NpdGl2ZU1heCgtJG1faiQuYy5tX2Zsb3csc19xKSkgKwogICAgICAgICAgICAgICAgIHN1bShwb3NpdGl2ZU1heCgkY19rJC5tX2Zsb3csc19xKSkpCgkJICBmb3IgaiBpbiAxOk4gYW5kICRtX2okLmMubV9mbG93Lm1pbiA8IDAsCiAgICAgICAgICAgICAgICAgIGZvciBrIGluIDE6TSBhbmQgayA8PiBxIGFuZCAkY19rJC5tX2Zsb3cubWF4ID4gMAplbmQgZm9yOw==">⬇</a></div>
<div id="lstnumberx3393" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3393.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow.min</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">all</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">with</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&lt;&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">and</span>
</div>
<div id="lstnumberx3394" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">   </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3394.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow.max</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&lt;=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">all</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span>
</div>
<div id="lstnumberx3395" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">then</span>
</div>
<div id="lstnumberx3396" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">    </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3396.m1" class="ltx_Math" alttext="m_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">i</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3396.m2" class="ltx_Math" alttext="m_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">i</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
<div id="lstnumberx3397" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">else</span>
</div>
<div id="lstnumberx3398" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">    </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">si</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3398.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">cat</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(1,1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">i</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">-1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">i</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span>
</div>
<div id="lstnumberx3399" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">         </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3399.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span>
</div>
<div id="lstnumberx3400" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">    </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3400.m1" class="ltx_Math" alttext="m_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">i</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span>
</div>
<div id="lstnumberx3401" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">       </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">positiveMax</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3401.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3401.m2" class="ltx_Math" alttext="s_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathvariant="normal">i</mi></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)*</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3401.m3" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span>
</div>
<div id="lstnumberx3402" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">      </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">positiveMax</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3402.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">s_i</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)*</span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3402.m2" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)))/</span>
</div>
<div id="lstnumberx3403" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">     </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">positiveMax</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3403.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">s_i</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">))</span>
</div>
<div id="lstnumberx3404" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">        </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">positiveMax</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3404.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">s_i</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)))</span>
</div>
<div id="lstnumberx3405" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">                  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">i</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&lt;&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3405.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow.min</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&lt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0,</span>
</div>
<div id="lstnumberx3406" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">                  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3406.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow.max</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span>
</div>
<div id="lstnumberx3407" class="ltx_listingline">
<span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>Additional<span class="ltx_text ltx_lst_space"> </span>equations<span class="ltx_text ltx_lst_space"> </span>to<span class="ltx_text ltx_lst_space"> </span>be<span class="ltx_text ltx_lst_space"> </span>generated</span>
</div>
<div id="lstnumberx3408" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">loop</span>
</div>
<div id="lstnumberx3409" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">   </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3409.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow.min</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">all</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">and</span>
</div>
<div id="lstnumberx3410" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">       </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3410.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow.max</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&lt;=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">all</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&lt;&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span>
</div>
<div id="lstnumberx3411" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">   </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">then</span>
</div>
<div id="lstnumberx3412" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">       </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3412.m1" class="ltx_Math" alttext="c_{q}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">q</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0;</span>
</div>
<div id="lstnumberx3413" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">    </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">else</span>
</div>
<div id="lstnumberx3414" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">       </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3414.m1" class="ltx_Math" alttext="s_{q}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathvariant="normal">q</mi></msub></math></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3414.m2" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span>
</div>
<div id="lstnumberx3415" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">                    </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3415.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">cat</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(1,1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">-1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)));</span>
</div>
<div id="lstnumberx3416" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">       </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3416.m1" class="ltx_Math" alttext="c_{q}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">q</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">positiveMax</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3416.m2" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">s_q</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)*</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3416.m3" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span>
</div>
<div id="lstnumberx3417" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">                 </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">positiveMax</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3417.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3417.m2" class="ltx_Math" alttext="s_{q}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathvariant="normal">q</mi></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3417.m3" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)))/</span>
</div>
<div id="lstnumberx3418" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">                </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">positiveMax</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3418.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">s_q</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">))</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span>
</div>
<div id="lstnumberx3419" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">                 </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">sum</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">positiveMax</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3419.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">s_q</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)))</span>
</div>
<div id="lstnumberx3420" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">                  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">j</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">N</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3420.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow.min</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&lt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0,</span>
</div>
<div id="lstnumberx3421" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">                  </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">in</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1:</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">M</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">k</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&lt;&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">q</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">and</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3421.m1" class="ltx_Math" alttext="c_{k}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">c</mi><mi mathbackground="#FFFFFF" mathvariant="normal">k</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.m_flow.max</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span>
</div>
<div id="lstnumberx3422" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">end</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">for</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
</div>
</li>
</ul>
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">The operator</span>
<span class="ltx_text ltx_font_typewriter">positiveMax(-m<sub class="ltx_sub">j</sub>.c.m_flow,s<sub class="ltx_sub">i</sub>)</span>
<span class="ltx_text ltx_emph ltx_font_italic">should be such that:</span></p>
</div>
<div id="Ch15.S2.p21" class="ltx_para">
<ul id="Ch15.S2.I3" class="ltx_itemize">
<li id="Ch15.S2.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I3.i1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">positiveMax(-m<sub class="ltx_sub">j</sub>.c.m_flow,s<sub class="ltx_sub">i</sub>) =
-m<sub class="ltx_sub">j</sub>.c_m_flow if
-m<sub class="ltx_sub">j</sub>.c.m_flow&gt;eps1<sub class="ltx_sub">j</sub>&gt;=0,
where eps1<sub class="ltx_sub">j</sub> are small flows, compared to typical
problem-specific value,</span></p>
</div>
</li>
<li id="Ch15.S2.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I3.i2.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">all denominators should be &gt; eps2 &gt; 0,
where eps2 is also a small flow, compared to typical problem-specific
values.</span></p>
</div>
</li>
</ul>
</div>
<div id="Ch15.S2.p22" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">Trivial implementation of positiveMax guarantees continuity of</span>
<span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">()</span></span><span class="ltx_text ltx_emph ltx_font_italic">:</span></p>
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,cG9zdGl2ZU1heCgtJG1faiQuYy5tX2Zsb3csICRzX2kkKT0gbWF4KC1tX2ouYy5tX2Zsb3csIGVwczEpOyAvLyBzbyAkc19pJCBpcyBub3QgbmVlZGVk">⬇</a></div>
<div id="lstnumberx3423" class="ltx_listingline">
<span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">postiveMax</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3423.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3423.m2" class="ltx_Math" alttext="s_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathvariant="normal">i</mi></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">m_j.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">eps1</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>so<span class="ltx_text ltx_lst_space"> </span><math id="lstnumberx3423.m3" class="ltx_Math" alttext="s_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">i</mi></msub></math><span class="ltx_text ltx_lst_space"> </span>is<span class="ltx_text ltx_lst_space"> </span>not<span class="ltx_text ltx_lst_space"> </span>needed</span>
</div>
</div>
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">More sophisticated implementation, with smooth approximation,
applied only when all flows are small:</span></p>
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,Ly8gRGVmaW5lIGEgInNtYWxsIG51bWJlciIgZXBzICghXHRleHRiZntub21pbmFsfSEodikgaXMgdGhlIG5vbWluYWwgdmFsdWUgb2YgdiAhLS0hIHNlZSAhXGF1dG9yZWZ7YXR0cmlidXRlcy1zdGFydC1maXhlZC1ub21pbmFsLWFuZC11bmJvdW5kZWR9ISkKICBlcHMgOj0gcmVsYXRpdmVUb2xlcmFuY2UqbWluKG5vbWluYWwoJG1faiQuYy5tX2Zsb3cpKTsKCi8vIERlZmluZSBhIHNtb290aCBjdXJ2ZSwgc3VjaCB0aGF0ICBhbHBoYSgkc19pPj1lcHMkKT0xIGFuZCBhbHBoYSgkc19pPDAkKT0wCiAgYWxwaGEgOj0gc21vb3RoKDEsIGlmICRzX2kkID4gZXBzIHRoZW4gMSBlbHNlCiAgICAgICAgICAgICAgICAgICAgIGlmICRzX2kkID4gMCB0aGVuICAoICRzX2kkL2VwcyleMiooMy0yKiAkc19pJC9lcHMpKSBlbHNlIDApOwoKICAvLyBEZWZpbmUgZnVuY3Rpb24gcG9zaXRpdmVNYXgodixzX2kpIGFzIGEgbGluZWFyIGNvbWJpbmF0aW9uIG9mIG1heCAodiwwKQogIC8vIGFuZCBvZiBlcHMgYWxvbmcgYWxwaGEKICBwb3NpdGl2ZU1heCgoLSRtX2okLmMubV9mbG93LHNfaSkgIDo9IGFscGhhKm1heCgtJG1faiQuYy5tX2Zsb3csMCkgKyAgKDEtYWxwaGEpKmVwczs=">⬇</a></div>
<div id="lstnumberx3424" class="ltx_listingline">
<span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>Define<span class="ltx_text ltx_lst_space"> </span>a<span class="ltx_text ltx_lst_space"> </span>”small<span class="ltx_text ltx_lst_space"> </span>number”<span class="ltx_text ltx_lst_space"> </span>eps<span class="ltx_text ltx_lst_space"> </span>(<span class="ltx_text ltx_font_bold" style="color:#006600;">nominal</span>(v)<span class="ltx_text ltx_lst_space"> </span>is<span class="ltx_text ltx_lst_space"> </span>the<span class="ltx_text ltx_lst_space"> </span>nominal<span class="ltx_text ltx_lst_space"> </span>value<span class="ltx_text ltx_lst_space"> </span>of<span class="ltx_text ltx_lst_space"> </span>v<span class="ltx_text ltx_lst_space"> </span>–<span class="ltx_text ltx_lst_space"> </span>see<span class="ltx_text ltx_lst_space"> </span><a href="Ch4.html#attributes-start-fixed-nominal-and-unbounded" title="4.8.7 Attributes start, fixed, nominal, and unbounded ‣ 4.8 Predefined Types and Classes ‣ Chapter 4 Classes, Predefined Types, and Declarations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref"><span class="ltx_text ltx_ref_tag">section 4.8.7</span></a>)</span>
</div>
<div id="lstnumberx3425" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">eps</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">relativeTolerance</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">*</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">min</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">nominal</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3425.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">));</span>
</div>
<div id="lstnumberx3426" class="ltx_listingline">
</div>
<div id="lstnumberx3427" class="ltx_listingline">
<span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>Define<span class="ltx_text ltx_lst_space"> </span>a<span class="ltx_text ltx_lst_space"> </span>smooth<span class="ltx_text ltx_lst_space"> </span>curve,<span class="ltx_text ltx_lst_space"> </span>such<span class="ltx_text ltx_lst_space"> </span>that<span class="ltx_text ltx_lst_space">  </span>alpha(<math id="lstnumberx3427.m1" class="ltx_Math" alttext="s_{i}&gt;=eps" display="inline"><mrow><msub><mi mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">i</mi></msub><mo mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">≥</mo><mrow><mi mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">e</mi><mo mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="sans-serif">⁢</mo><mi mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">p</mi><mo mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="sans-serif">⁢</mo><mi mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">s</mi></mrow></mrow></math>)=1<span class="ltx_text ltx_lst_space"> </span>and<span class="ltx_text ltx_lst_space"> </span>alpha(<math id="lstnumberx3427.m2" class="ltx_Math" alttext="s_{i}&lt;0" display="inline"><mrow><msub><mi mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">i</mi></msub><mo mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">&lt;</mo><mn mathbackground="#FFFFFF" mathcolor="#006600" mathvariant="normal">0</mn></mrow></math>)=0</span>
</div>
<div id="lstnumberx3428" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">alpha</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">smooth</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(1,</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3428.m1" class="ltx_Math" alttext="s_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathvariant="normal">i</mi></msub></math></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">eps</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">1</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">else</span>
</div>
<div id="lstnumberx3429" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">                     </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3429.m1" class="ltx_Math" alttext="s_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathvariant="normal">i</mi></msub></math></span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3429.m2" class="ltx_Math" alttext="s_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathvariant="normal">i</mi></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">/</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">eps</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)^2*(3-2*</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3429.m3" class="ltx_Math" alttext="s_{i}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">s</mi><mi mathbackground="#FFFFFF" mathvariant="normal">i</mi></msub></math></span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">/</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">eps</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">))</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">else</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0);</span>
</div>
<div id="lstnumberx3430" class="ltx_listingline">
</div>
<div id="lstnumberx3431" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>Define<span class="ltx_text ltx_lst_space"> </span>function<span class="ltx_text ltx_lst_space"> </span>positiveMax(v,s_i)<span class="ltx_text ltx_lst_space"> </span>as<span class="ltx_text ltx_lst_space"> </span>a<span class="ltx_text ltx_lst_space"> </span>linear<span class="ltx_text ltx_lst_space"> </span>combination<span class="ltx_text ltx_lst_space"> </span>of<span class="ltx_text ltx_lst_space"> </span>max<span class="ltx_text ltx_lst_space"> </span>(v,0)</span>
</div>
<div id="lstnumberx3432" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>and<span class="ltx_text ltx_lst_space"> </span>of<span class="ltx_text ltx_lst_space"> </span>eps<span class="ltx_text ltx_lst_space"> </span>along<span class="ltx_text ltx_lst_space"> </span>alpha</span>
</div>
<div id="lstnumberx3433" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">positiveMax</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">((-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3433.m1" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">s_i</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">:=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">alpha</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">*</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">max</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(-</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;"><math id="lstnumberx3433.m2" class="ltx_Math" alttext="m_{j}" display="inline"><msub><mi mathbackground="#FFFFFF" mathvariant="normal">m</mi><mi mathbackground="#FFFFFF" mathvariant="normal">j</mi></msub></math></span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">.c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">,0)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">+</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(1-</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">alpha</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)*</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">eps</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
</div>
<div id="Ch15.S2.p23" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">The derivation of this implementation is discussed in</span>
<a href="A4.html" title="Appendix D Derivation of Stream Equations ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref ltx_refmacro_autoref ltx_font_italic"><span class="ltx_text ltx_ref_tag">Appendix D</span></a><span class="ltx_text ltx_emph ltx_font_italic">. Note that in the cases N = 1, M =0 (unconnected port,
physically corresponding to a plugged-up flange), and N = 2, M=0
(one-to-one connection), the result of <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter ltx_font_upright" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter ltx_font_upright" style="font-size:90%;">()</span></span> is trivial
and no non-linear equations are left in the model, despite the fact that
the original definition equations are nonlinear.</span></p>
</div>
<div id="Ch15.S2.p24" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">The following properties hold for this implementation:</span></p>
</div>
<div id="Ch15.S2.p25" class="ltx_para">
<ul id="Ch15.S2.I4" class="ltx_itemize">
<li id="Ch15.S2.I4.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I4.i1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(<span class="ltx_text ltx_lst_identifier">..</span>)</span></span> <span class="ltx_text ltx_emph ltx_font_italic">is continuous (and differentiable),
provided that</span> <span class="ltx_text ltx_font_typewriter">m<sub class="ltx_sub">j</sub>.c.h_outflow,
m<sub class="ltx_sub">j</sub>.c.m_flow,
c<sub class="ltx_sub">k</sub>.h_outflow</span><span class="ltx_text ltx_emph ltx_font_italic">, and</span>
<span class="ltx_text ltx_font_typewriter">c<sub class="ltx_sub">k</sub>.m_flow</span> <span class="ltx_text ltx_emph ltx_font_italic">are continuous and differentiable.</span></p>
</div>
</li>
</ul>
</div>
<div id="Ch15.S2.p26" class="ltx_para">
<ul id="Ch15.S2.I5" class="ltx_itemize">
<li id="Ch15.S2.I5.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I5.i1.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">A division by zero can no longer occur (since</span> <span class="ltx_text ltx_font_typewriter">sum(positiveMax(-m<sub class="ltx_sub">j</sub>.c.m_flow,s<sub class="ltx_sub">i</sub>))&gt;=eps2
&gt; 0)</span><span class="ltx_text ltx_emph ltx_font_italic">, so the result is always well-defined.</span></p>
</div>
</li>
<li id="Ch15.S2.I5.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I5.i2.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">The balance equations are exactly fulfilled if the denominator
is not close to zero
<br class="ltx_break">(since the exact formula is used, if</span>
<span class="ltx_text ltx_font_typewriter">sum(positiveMax(-m<sub class="ltx_sub">j</sub>.c.m_flow,s<sub class="ltx_sub">i</sub>)
) &gt; eps).</span></p>
</div>
</li>
<li id="Ch15.S2.I5.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Ch15.S2.I5.i3.p1" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">If all flows are zero,</span>
<span class="ltx_text ltx_font_typewriter">inStream(m<sub class="ltx_sub">i</sub>.c.h_outflow) =
sum(m<sub class="ltx_sub">j</sub>.c.h_outflow for
j&lt;&gt;i and m<sub class="ltx_sub">j</sub>.c.m_flow.min &lt;
0)/Np</span><span class="ltx_text ltx_emph ltx_font_italic">, i.e., it is the mean value of all the</span> <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">Np</span> <span class="ltx_text ltx_emph ltx_font_italic">variables</span>
<span class="ltx_text ltx_font_typewriter">m<sub class="ltx_sub">j</sub>.c.h_outflow</span><span class="ltx_text ltx_emph ltx_font_italic">, such that</span> <span class="ltx_text ltx_font_typewriter">
j&lt;&gt;i</span> <span class="ltx_text ltx_emph ltx_font_italic">and</span>
<span class="ltx_text ltx_font_typewriter">m<sub class="ltx_sub">j</sub>.c.m_flow.min &lt; 0</span><span class="ltx_text ltx_emph ltx_font_italic">. This is a
meaningful approximation, considering the physical diffusion effects
that are relevant at small flow rates in a small connection volume
(thermal conduction for enthalpy, mass diffusion for mass fractions).</span></p>
</div>
</li>
</ul>
</div>
<div id="Ch15.S2.p27" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">The value of relativeTolerance should be larger than the relative
tolerance of the nonlinear solver used to solve the implicit algebraic
equations.</span></p>
</div>
<div id="Ch15.S2.p28" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">As a final remark, further symbolic simplifications could be
carried out by taking into account equations that affect the flows in
the connection set (i.e., equivalent to m<sub class="ltx_sub">j</sub>.c.m_flow =
0, which then implies m<sub class="ltx_sub">j</sub>.c.m_flow.min &gt;=
0). This is interesting, e.g., in the case of a valve when the stem
position is set identically to closed by its controller.</span></p>
</div>
<div id="Ch15.S2.p29" class="ltx_para">
<p class="ltx_p">]</p>
</div>
</section>
<section id="stream-operator-actualstream" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">15.3 </span>Stream Operator actualStream</h2>

<div id="Ch15.S3.p1" class="ltx_para">
<p class="ltx_p">The <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting" style="background-color:#FFFFFF;"><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">actualStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(<span class="ltx_text ltx_lst_identifier">v</span>)</span></span> operator is provided for convenience, in
order to return the actual value of the stream variable, depending on
the actual flow direction. The only argument of this built-in operator
needs to be a reference to a stream variable. The operator is
vectorizable, in the case of vector arguments. For the following
definition it is assumed that an (inside or outside) connector <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">c</span>
contains a stream variable <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">h_outflow</span> which is associated with a flow
variable <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">m_flow</span> in the same connector <span class="ltx_text ltx_lst_language_modelica_short ltx_lstlisting ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;background-color:#FFFFFF;">c</span>:</p>
</div>
<div id="Ch15.S3.p2" class="ltx_para">
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,YWN0dWFsU3RyZWFtKGMuaF9vdXRmbG93KSA9IGlmIGMubV9mbG93ID4gMCB0aGVuIGluU3RyZWFtKGMuaF9vdXRmbG93KSBlbHNlIGMuaF9vdXRmbG93Ow==">⬇</a></div>
<div id="lstnumberx3434" class="ltx_listingline">
<span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">actualStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">if</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c.m_flow</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">&gt;</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">0</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">then</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">inStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords2 ltx_font_typewriter ltx_font_bold" style="font-size:90%;color:#000066;">else</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">;</span>
</div>
</div>
</div>
<div id="Ch15.S3.p3" class="ltx_para">
<p class="ltx_p">[<span class="ltx_text ltx_emph ltx_font_italic">The <span class="ltx_text ltx_font_bold">actualStream</span>(v) operator is typically used in two
contexts:</span></p>
<div class="ltx_listing ltx_lst_language_modelica ltx_lstlisting ltx_listing" style="background-color:#FFFFFF;">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ICBkZXIoVSkgPSBjLm1fZmxvdyphY3R1YWxTdHJlYW0oYy5oX291dGZsb3cpOyAgLy8gKDEpZW5lcmd5IGJhbGFuY2UgZXF1YXRpb24KICBoX2MgPSBhY3R1YWxTdHJlYW0oYy5oKTsgICAgICAgICAgICAgICAgICAgICAgLy8gKDIpbW9uaXRvcmluZyB0aGUgZW50aGFscHkgYXQgcG9ydCBj">⬇</a></div>
<div id="lstnumberx3435" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">der</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">U</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">)</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c.m_flow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">*</span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">actualStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c.h_outflow</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>(1)energy<span class="ltx_text ltx_lst_space"> </span>balance<span class="ltx_text ltx_lst_space"> </span>equation</span>
</div>
<div id="lstnumberx3436" class="ltx_listingline">
<span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">  </span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">h_c</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">=</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;"> </span><span class="ltx_text ltx_lst_keywords3 ltx_font_typewriter" style="font-size:90%;color:#E60000;">actualStream</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">(</span><span class="ltx_text ltx_lst_identifier ltx_font_typewriter" style="font-size:90%;">c.h</span><span class="ltx_text ltx_font_typewriter" style="font-size:90%;">);</span><span class="ltx_text ltx_lst_space ltx_font_typewriter" style="font-size:90%;">                      </span><span class="ltx_text ltx_lst_comment ltx_font_sansserif" style="font-size:90%;color:#006600;">//<span class="ltx_text ltx_lst_space"> </span>(2)monitoring<span class="ltx_text ltx_lst_space"> </span>the<span class="ltx_text ltx_lst_space"> </span>enthalpy<span class="ltx_text ltx_lst_space"> </span>at<span class="ltx_text ltx_lst_space"> </span>port<span class="ltx_text ltx_lst_space"> </span>c</span>
</div>
</div>
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">In the case of equation (1), although the actualStream() operator
is discontinuous, the product with the flow variable is not, because
actualStream() is discontinuous when the flow is zero by construction.
Therefore, a tool might infer that the expression is smooth(0, …)
automatically, and decide whether or not to generate an event. If a user
wants to avoid events entirely, he/she may enclose the right-hand side
of (1) with the noEvent() operator. </span></p>
</div>
<div id="Ch15.S3.p4" class="ltx_para">
<p class="ltx_p"><span class="ltx_text ltx_emph ltx_font_italic">Equations like (2) might be used for monitoring purposes (e.g.
plots), in order to inspect what the ‘actual’ enthalpy of the fluid
flowing through a port is. In this case, the user will probably want to
see the change due to flow reversal at the exact instant, so an event
should be generated. If the user doesn’t bother, then he/she should
enclose the right-hand side of (2) with noEvent(). Since the output of
actualStream() will be discontinuous, it should not be used by itself to
model physical behaviour (e.g., to compute densities used in momentum
balances) - inStream() should be used for this purpose. The operator
actualStream() should be used to model physical behaviour only when
multiplied by the corresponding flow variable (like in the above energy
balance equation), because this removes the discontinuity.</span></p>
</div>
<div id="Ch15.S3.p5" class="ltx_para">
<p class="ltx_p">]</p>
</div>
</section>
</section>
</div>
<footer class="ltx_page_footer">
<div>
<a href="Ch14.html" title="Chapter 14 Overloaded Operators ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref" rel="prev"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">14 </span>Overloaded Operators</span></a><a href="Ch16.html" title="Chapter 16 Synchronous Language Elements ‣ Modelica® - A Unified Object-Oriented Language for Systems Modeling Language Specification Version 3.4" class="ltx_ref" rel="next"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">16 </span>Synchronous Language Elements</span></a>
</div>
<div class="ltx_page_logo">Generated  on Sat May  1 09:01:01 2021 by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>
</body>
</html>
